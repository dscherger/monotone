<html lang="en">
<head><link type="text/css" rel="stylesheet" href="texinfo.css" />
<title>Conflicts - monotone documentation</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="monotone documentation">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Tree.html#Tree" title="Tree">
<link rel="prev" href="Tree.html#Tree" title="Tree">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Conflicts"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Tree.html#Tree">Tree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Tree.html#Tree">Tree</a>
<hr>
</div>

<h4 class="subsection">5.1.1 Conflicts</h4>

<p>The <samp><span class="command">conflicts</span></samp> set of commands is used to specify conflict
resolutions for merges, asynchronously from the merge command itself. 
This lets the user take as much time as needed to prepare all the
conflict resolutions, and avoids losing work when a merge is aborted
due to a complicated conflict.

<p>These commands require a workspace, to provide a place to store the
conflicts and user resolution files.

<p>For all of these commands, if the <samp><span class="command">--conflicts-file</span></samp> option is
not given, the file <samp><span class="file">_MTN/conflicts</span></samp> is used. If the
<samp><span class="command">--conflicts-file</span></samp> option is given, the file must be in the
bookkeeping directory.

<p>Files given in these commands are relative to the current working
directory, or absolute. In the conflict file, they are relative to the
workspace root, or absolute.

<h4 class="subheading">Commands</h4>

     <dl>
<dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> store </span><var>left_rev_id</var> <var>right_rev_id</var></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-store-_0040var_007bleft_005frev_005fid_007d-_0040var_007bright_005frev_005fid_007d-16"></a><dd>Store the conflicts encountered by merging <var>left_rev_id</var> with
<var>right_rev_id</var>, in the specified file.

     <p>If <var>left_rev_id</var> and <var>right_rev_id</var> are not given, the first
two heads that the <samp><span class="command">merge</span></samp> command would merge are used.

     <p>The conflicts file format is as output by the <samp><span class="command">automate
show_conflicts</span></samp> command; see See <a href="Automation.html#Automation">Automation</a>.

     <p>Content conflicts that can be resolved by the internal line merger
have resolutions, so they will not show up in subsequent
<samp><span class="command">show_first</span></samp> commands.

     <br><dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> show_first</span></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-show_005ffirst-17"></a><dd>Show the first unresolved conflict in the conflicts file, and list the
possible resolutions.

     <br><dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> show_remaining</span></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-show_005fremaining-18"></a><dd>Show remaining unresolved conflicts in the conflicts file.

     <br><dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> resolve_first </span><var>resolution</var></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-resolve_005ffirst-_0040var_007bresolution_007d-19"></a><dd>Specify a resolution for the first conflict in the conflicts file; it
must be a single file conflict. The conflicts file is updated.

     <br><dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> resolve_first_left </span><var>resolution</var></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-resolve_005ffirst_005fleft-_0040var_007bresolution_007d-20"></a><dt><samp><span class="command">mtn conflicts --conflicts-file=</span><var>file</var><span class="command"> resolve_first_right </span><var>resolution</var></samp><a name="index-mtn-conflicts-_002d_002dconflicts_002dfile_003d_0040var_007bfile_007d-resolve_005ffirst_005fright-_0040var_007bresolution_007d-21"></a><dd>Specify a resolution for one of the files in the first conflict in the
conflicts file; it must be a two file conflict. The conflicts file is
updated.

     <br><dt><samp><span class="command">mtn conflicts clean</span></samp><a name="index-mtn-conflicts-clean-22"></a><dd>Delete the default conflicts file <samp><span class="file">_MTN/conflicts</span></samp>, and the
directory <samp><span class="file">_MTN/resolutions</span></samp>. Users may store conflict
resolution files in <samp><span class="file">_MTN/resolutions</span></samp>; this command provides a
convenient way to clean up. 
</dl>

<h4 class="subheading">Single file conflict resolutions</h4>

<p>For single file conflicts, there are several possible resolutions:

     <dl>
<dt><samp><span class="command">interactive </span><var>file</var></samp><a name="index-interactive-_0040var_007bfile_007d-23"></a><dd>The Lua <code>merge3</code> hook is called to allow the user to manually
merge the left and right files, leaving the result in the specified file.

     <p><var>file</var> must be a bookkeeping path; under <samp><span class="file">_MTN</span></samp>.

     <p>This inserts a <var>resolved_user_left file</var> conflict resolution in the
conflicts file.

     <br><dt><samp><span class="command">user </span><var>file</var></samp><a name="index-user-_0040var_007bfile_007d-24"></a><dd>The file contents are replaced by the contents of the specified file.

     <p>This inserts a <var>resolved_user_left file</var> conflict resolution in the
conflicts file.

     <br><dt><samp><span class="command">drop</span></samp><a name="index-drop-25"></a><dd>The file is dropped in the merge. This is useful for an orphaned file
conflict.

     <p>This inserts a <var>resolved_drop_left</var> conflict resolution in the
conflicts file.

     <br><dt><samp><span class="command">rename </span><var>filename</var></samp><a name="index-rename-_0040var_007bfilename_007d-26"></a><dd>The file is renamed. This is useful for an orphaned file
conflict.

     <p>This inserts a <var>resolved_rename_left filename</var> conflict resolution
in the conflicts file.

</dl>

<h4 class="subheading">Two file conflict resolutions</h4>

<p>For two file conflicts, the possible resolutions are:

     <dl>
<dt><samp><span class="command">drop</span></samp><a name="index-drop-27"></a><dd>The file is dropped in the merge.

     <p>This inserts a <var>resolved_drop_left</var> or <var>resolved_drop_right</var>
conflict resolution in the conflicts file.

     <br><dt><samp><span class="command">keep</span></samp><a name="index-keep-28"></a><dd>The file is kept in the merge.

     <p>This inserts a <var>resolved_keep_left</var> or <var>resolved_keep_right</var>
conflict resolution in the conflicts file.

     <br><dt><samp><span class="command">rename </span><var>filename</var></samp><a name="index-rename-_0040var_007bfilename_007d-29"></a><dd>The file is renamed.

     <p>This inserts a <var>resolved_rename_left filename</var> or
<var>resolved_rename_right filename</var> conflict resolution in the
conflicts file.

     <br><dt><samp><span class="command">user </span><var>file</var></samp><a name="index-user-_0040var_007bfile_007d-30"></a><dd>The file contents are replaced by the contents of the specified file. 
The other file in the conflict must be dropped or renamed.

     <p>This inserts a <var>resolved_user_left file</var> or
<var>resolved_user_right file</var> conflict resolution in the conflicts
file.

</dl>

<p>monotone internals note: we don't provide an <code>interactive</code>
resolution for two-file conflicts, because monotone currently does not
provide a <code>merge2</code> Lua hook. two-file conflicts don't have a
shared ancestor, so <code>merge3</code> is not applicable.

</body></html>

