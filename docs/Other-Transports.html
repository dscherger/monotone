<html lang="en">
<head><link type="text/css" rel="stylesheet" href="texinfo.css" />
<title>Other Transports - monotone documentation</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="monotone documentation">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Advanced-Uses.html#Advanced-Uses" title="Advanced Uses">
<link rel="next" href="Selectors.html#Selectors" title="Selectors">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Other-Transports"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Selectors.html#Selectors">Selectors</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Advanced-Uses.html#Advanced-Uses">Advanced Uses</a>
<hr>
</div>

<h3 class="section">3.1 Other Transports</h3>

<p>Monotone's database synchronization system is based on a protocol
called netsync. By default, monotone transports this protocol over a
plain TCP connection, but this is not the only transport monotone can
use. It can also transport netsync through SSH, or any program which
can provide a full-duplex connection over <code>stdio</code>.

   <p>When a monotone client initiates a push, pull, or sync operation, it
parses the first command-line argument as a URI and calls a Lua hook
to convert that URI into a <dfn>connection command</dfn>. If the Lua hook
returns a connection command, monotone spawns the command locally and
speaks netsync over a pipe connected to the command's standard I/O
handles.

   <p>If the Lua hook does not return a connection command, monotone
attempts to parse the command-line argument as a TCP address &ndash; a
hostname with an optional port number &ndash; connects a TCP socket the
host and port, and speaks netsync over the socket.

   <p>By default, monotone understands two URI schemes:

     <ol type=1 start=1>
<li>SSH URIs, of the form
  <code>ssh://[</code><var>user</var><code>@]</code><var>hostname</var><code>[:</code><var>port</var><code>]/</code><var>path/to/db.mtn</var>,
  to synchronize between private databases on hosts accessible only
  through SSH.  (These paths are absolute; to refer to a path relative
  to a home directory, use
  <code>ssh://</code><var>host-part</var><code>/~/</code><var>relative/path.mtn</var> or
  <code>ssh://</code><var>host-part</var><code>/~</code><var>user</var><code>/</code><var>relative/path.mtn</var>.) 
<li>File URIs, of the form
  <code>file:</code><var>/path/to/db.mtn</var>, to synchronize between local databases.
        </ol>

   <p>In the case of SSH URIs, the <samp><span class="command">ssh</span></samp> program must be in your
command execution path, either <var>$PATH</var> on Unix-like systems or
<var>%PATH%</var> on Windows systems. Monotone will execute <samp><span class="command">ssh</span></samp>
as a subprocess, running <samp><span class="command">mtn serve</span></samp> on the other end of the
SSH connection. You will need <samp><span class="command">mtn</span></samp> to be in the command
execution path of the remote shell environment.

   <p>In the case of File URIs, <samp><span class="command">mtn</span></samp> is run locally, so must be
in your command execution path.

   <p>In both cases, the database specified in the URI needs to exist already,
and will be locked for the duration of the synchronization
operation. Therefore, it must also be writable, even when monotone isn't
going to modify it, as it is the case for <samp><span class="command">pull</span></samp>.  Also note
that monotone's default transport authentication is <em>disabled</em> over
these transports, to reduce the complexity of configuration and
eliminate redundant protocol cost.

   <p>Additional URI schemes can be supported by customization of the Lua
hooks <code>get_netsync_connect_command</code> and
<code>use_transport_auth</code>. For details on these hooks, see
<a href="Netsync-Transport-Hooks.html#Netsync-Transport-Hooks">Netsync Transport Hooks</a>.

   </body></html>

