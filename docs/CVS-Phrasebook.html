<html lang="en">
<head><link type="text/css" rel="stylesheet" href="texinfo.css" />
<title>CVS Phrasebook - monotone documentation</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="monotone documentation">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="prev" href="Advanced-Uses.html#Advanced-Uses" title="Advanced Uses">
<link rel="next" href="Command-Reference.html#Command-Reference" title="Command Reference">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="CVS-Phrasebook"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Command-Reference.html#Command-Reference">Command Reference</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Advanced-Uses.html#Advanced-Uses">Advanced Uses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr>
</div>

<h2 class="chapter">4 CVS Phrasebook</h2>

<p>This chapter translates common CVS commands into monotone commands. It
is an easy alternative to reading through the complete command
reference.

<h3 class="heading">Checking Out a Tree</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ CVSROOT=:pserver:cvs.foo.com/wobbler
$ cvs -d $CVSROOT checkout -r 1.2
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn pull www.foo.com com.foo.wobbler*
$ mtn checkout --revision=fe37 wobbler
</pre>
<p><br></td></tr></table>

<p>The CVS command contacts a network server, retrieves a revision, and
stores it in your workspace. There are two cosmetic differences
with the monotone command: remote databases are specified by hostnames
and globs, and revisions are denoted by <span class="sc">sha1</span> values (or
selectors).

<p>There is also one deep difference: pulling revisions into your
database is a separate step from checking out a single revision; after
you have pulled from a network server, your database will contain
<em>several</em> revisions, possibly the entire history of a
project. Checking out is a separate step, after communication, which
only copies a particular revision out of your database and into a named
directory.

<h3 class="heading">Committing Changes</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs commit -m "log message"
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn commit --message="log message"
$ mtn push www.foo.com com.foo.wobbler*
</pre>
<p><br></td></tr></table>

<p>As with other networking commands, the communication step with
monotone is explicit: committing changes only saves them to the local
database. A separate command, <samp><span class="command">push</span></samp>, sends the changes to a
remote database.

<h3 class="heading">Undoing Changes</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs update -C file
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn revert file
</pre>
<p><br></td></tr></table>

<p>Unlike CVS, monotone includes a separate <samp><span class="command">revert</span></samp> command for
undoing local changes and restoring the workspace to the original
contents of the base revision. Because this can be dangerous,
<samp><span class="command">revert</span></samp> insists on an explicit argument to name the files or
directories to be reverted; use the current directory "<samp><span class="file">.</span></samp>" at the
top of the workspace to revert everything.  The <samp><span class="command">revert</span></samp> command
is also used to restore deleted files (with a convenient
<samp><span class="option">--missing</span></samp> option for naming these files).

<p>In CVS, you would need to use <samp><span class="command">update</span></samp> to restore missing or
changed files, and you might get back a newer version of the file than
you started with. In monotone, <samp><span class="command">revert</span></samp> always takes you back to
where you started, and the <samp><span class="command">update</span></samp> command is only used to move
the workspace to a different (usually newer) base revision.

<h3 class="heading">Incorporating New Changes</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs update -d
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn pull www.foo.com com.foo.wobbler*
$ mtn merge
$ mtn update
</pre>
<p><br></td></tr></table>

<p>This command, like other networking commands, involves a separate
communication step with monotone. The extra command, <samp><span class="command">merge</span></samp>,
ensures that the branch your are working on has a unique head. You can
omit the <samp><span class="command">merge</span></samp> step if you only want <samp><span class="command">update</span></samp> to
examine descendants of your base revision, and ignore other heads on
your branch.

<h3 class="heading">Tagging Revisions</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs tag FOO_TAG .
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn tag h: FOO_TAG
</pre>
<p><br></td></tr></table>

<p>With CVS, tags are placed on individual files, and the closest thing to
identifying a consistent repository-wide revision is a set of files with
the same tag.  In monotone, all changes are part of a repository-wide
revision, and some of those revisions may be tagged.  Monotone has no
partial tags that apply only to a subset of files.

<h3 class="heading">Moving Workspace to Another Revision</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs update -r FOO_TAG -d
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn update -r 830ac1a5f033825ab364f911608ec294fe37f7bc
$ mtn update -r t:FOO_TAG
</pre>
<p><br></td></tr></table>

<p>With a revision parameter, the <samp><span class="command">update</span></samp> command operates
similarly in monotone and CVS. One difference is that a subsequent
<samp><span class="command">commit</span></samp> will be based off the chosen revision in monotone,
while a <samp><span class="command">commit</span></samp> in the CVS case is not possible without going
back to the branch head again.  This version of <samp><span class="command">update</span></samp> can
thus be very useful if, for example, you discover that the tree you are
working against is somehow broken &mdash; you can <samp><span class="command">update</span></samp> to an
older non-broken version, and continue to work normally while waiting
for the tree to be fixed.

<h3 class="heading">Viewing Differences</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs diff
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn diff
</pre>
<p><br></td></tr><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs diff -r 1.2 -r 1.4 myfile
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn diff -r 3e7db -r 278df myfile
</pre>
<p><br></td></tr></table>

<p>Monotone's <samp><span class="command">diff</span></samp> command is modeled on that of CVS, so the
main features are the same: <samp><span class="command">diff</span></samp> alone prints the
differences between your workspace and its base revision, whereas
<samp><span class="command">diff</span></samp> accompanied by two revision numbers prints the
difference between those two revisions. The major difference between
CVS and monotone here is that monotone's revision numbers are
<em>revision IDs</em>, rather than file IDs.  If one leaves off the file
argument, then diff can print the difference between two entire trees.

<h3 class="heading">Showing Workspace Status</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs status
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn status
</pre>
<p><br></td></tr></table>

<p>This command operates similarly in monotone and CVS. The only major
difference is that monotone's <samp><span class="command">status</span></samp> command always gives a
status of the whole tree, and outputs a more compact summary than CVS.

<h3 class="heading">Adding Directories and Files to Workspace</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs add dir
$ cvs add dir/subdir
$ cvs add dir/subdir/file.txt
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn add dir/subdir/file.txt
</pre>
<p><br></td></tr></table>

<p>Monotone does not explicitly store directories, so adding a file only
involves adding the file's complete path, including any directories. 
Directories are created as needed, and empty directories are ignored.

<h3 class="heading">Removing Directories and Files from Workspace</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ rm file.txt
$ cvs remove file.txt
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn drop file.txt
</pre>
<p><br></td></tr></table>

<p>Monotone does not require that you erase a file from the workspace
before you drop it. Dropping a file both removes its entry in the
manifest of the current revision and removes it from the filesystem.

<h3 class="heading">Viewing History</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs log [file]
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn log [file]
</pre>
<p><br></td></tr></table>

<p>Unlike CVS log, monotone log can also be used without a workspace; but
in this case you must pass a <samp><span class="option">--from</span></samp> revision argument to tell
monotone where to start displaying the log from.

<h3 class="heading">Importing a New Project</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs import wobbler vendor start
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn --db=/path/to/database.mtn --branch=com.foo.wobbler setup .
$ mtn add -R .
$ mtn commit
</pre>
<p><br></td></tr></table>

<p>The <samp><span class="command">setup</span></samp> command turns an ordinary directory into a
monotone workspace.  After that, you can add your files and commit
them as usual.

<h3 class="heading">Initializing a Repository</h3>

<p><table summary=""><tr align="left"><td valign="top" width="40%">
<pre class="smallexample">$ cvs init -d /path/to/repository
</pre>
<p></td><td valign="top" width="40%">
<pre class="smallexample">$ mtn db init --db=/path/to/database.mtn
</pre>
<p><br></td></tr></table>

<p>Monotone's &ldquo;repository&rdquo; is a single-file database, which is created
and initialized by this command. This file is only ever used by you,
and does not need to be in any special location, or readable by other
users.

</body></html>

