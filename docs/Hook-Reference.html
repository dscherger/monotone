<html lang="en">
<head><link type="text/css" rel="stylesheet" href="texinfo.css" />
<title>Hook Reference - monotone documentation</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="monotone documentation">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="prev" href="Command-Reference.html#Command-Reference" title="Command Reference">
<link rel="next" href="Special-Topics.html#Special-Topics" title="Special Topics">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Hook-Reference"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="Special-Topics.html#Special-Topics">Special Topics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Command-Reference.html#Command-Reference">Command Reference</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr>
</div>

<h2 class="chapter">6 Hook Reference</h2>

<p>Monotone's behavior can be customized and extended by writing
<dfn>hook functions</dfn>, which are written in the
<a href="http://www.lua.org">Lua</a> programming language. At certain points
in time, when monotone is running, it will call a hook function to
help it make a decision or perform some action.  If you provide a hook
function definition which suits your preferences, monotone will
execute it. This way you can modify how monotone behaves.

   <p>You can put new definitions for any of these hook functions in a file
<samp><span class="file">$HOME/.monotone/monotonerc</span></samp>, or in your workspace in
<samp><span class="file">_MTN/monotonerc</span></samp>, both of which will be read every time monotone
runs. Definitions in <samp><span class="file">_MTN/monotonerc</span></samp> shadow (override)
definitions made in your <samp><span class="file">$HOME/.monotone/monotonerc</span></samp>. You can also tell
monotone to interpret extra hook functions from any other <var>file</var>
using the <samp><span class="option">--rcfile=</span><var>file</var></samp> option; hooks defined in files
specified on the command-line will shadow hooks from the the automatic
files. 
By specifying <samp><span class="option">--rcfile=</span><var>directory</var></samp> you can automatically
load all the files contained into <var>directory</var>.

   <p>Monotone provides some default hooks, see <a href="Default-hooks.html#Default-hooks">Default hooks</a> for their
complete source. When writing new hooks, it may be helpful to reuse some code
from the default ones. Since Lua is a lexically scoped language with closures,
this can be achieved with the following code:

<pre class="smallexample">     do
     	local old_hook = default_hook
     	function default_hook(arg)
     		if not old_hook(arg) then
     			-- do other stuff
     		end
     	end
     end
</pre>
   <p>Now the default hook is trapped in a variable local to this block, and can
only be seen by the new hook. Since in Lua variables default to the global
scope, the new hook is seen from inside monotone.

   <p>Monotone also makes available to hook writers a number of helper
functions exposing functionality not available with standard Lua.

<ul class="menu">
<li><a accesskey="1" href="Hooks.html#Hooks">Hooks</a>:                        All hooks called by monotone. 
<li><a accesskey="2" href="Additional-Lua-Functions.html#Additional-Lua-Functions">Additional Lua Functions</a>:     Extra functionality available to hook writers. 
</ul>

   </body></html>

