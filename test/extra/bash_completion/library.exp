# Functions and starter for the bash completion tests

proc success {} {
    send_user "\n<<success>>\n"
}

proc failure {} {
    send_user "\n<<failure>>\n"
}

send_user "mtn = $mtn\n"
send_user "initial_dir = $initial_dir\n"
send_user "PATH = $env(PATH)\n"
# some user's ~/.bash_profile start xserver etc; don't do that
spawn "bash" "--init-file" "/dev/nul"
send "export PS1='@ '\n"
send "export PS2='_@ '\n"
send "pwd\n"
send ". /etc/bash_completion\n"
expect {
    -timeout 1
    "bash: /etc/bash_completion: " { failure; exit }
}
send ". $initial_dir/extra/shell/monotone.bash_completion\n"
# Wait for the last line to be echoed
expect "bash_completion2"
#stty rows 512
