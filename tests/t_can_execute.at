AT_SETUP([can execute things])
MONOTONE_SETUP

AT_DATA(touchhook.lua, [function note_commit(new_id, certs)
	local pid
	local ret = -1
	pid = spawn("touch", "test.touched")
	if (pid == -1) then
		return nil
	end
	ret, pid = wait(pid)
end
])
AT_CHECK(MONOTONE add touchhook.lua, [], [ignore], [ignore])
AT_CHECK(MONOTONE --branch=testbranch --rcfile=touchhook.lua commit --message 'test', [], [ignore], [ignore])
AT_CHECK(test -f test.touched, [], [ignore], [ignore])

AT_CLEANUP
