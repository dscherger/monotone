# -*- Autoconf -*-

AT_SETUP([quiet turns off tickers but not warnings])

MTN_SETUP
NETSYNC_SETUP

ADD_FILE(input.txt, [version 0 of the file
])
COMMIT(testbranch)

# check that tickers are quiet
NETSYNC_SERVE_START(testbranch)

AT_CHECK(MTN --db=test2.db --keydir=keys2 --rcfile=netsync.lua pull --quiet NETSYNC_ADDRESS testbranch, [], [], [stderr])
AT_CHECK(grep -v ': warning: ' stderr, [1], [ignore])

NETSYNC_SERVE_STOP

# check that warnings aren't...
# (list keys with a pattern that doesn't match anything generates a warning)
AT_CHECK(MTN --quiet list keys foo, [], [ignore], [stderr])
AT_CHECK(grep ': warning: ' stderr, [0], [ignore])

AT_CLEANUP
