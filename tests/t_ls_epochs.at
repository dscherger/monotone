AT_SETUP([ls epochs])

MTN_SETUP

ADD_FILE(testfile, [version 0 data
])
COMMIT(testbranch)

ADD_FILE(testfile2, [other data
])
COMMIT(otherbranch)

AT_CHECK(MTN db set_epoch testbranch 12345, [1], [ignore], [ignore])
AT_CHECK(MTN db set_epoch testbranch aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa, [], [ignore], [ignore])
AT_CHECK(MTN db set_epoch otherbranch bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb, [], [ignore], [ignore])

AT_CHECK(MTN list epochs, [], [stdout])
AT_CHECK(grep testbranch stdout, [0], [ignore])
AT_CHECK(grep otherbranch stdout, [0], [ignore])
AT_CHECK(MTN list epochs testbranch, [], [stdout])
AT_CHECK(grep testbranch stdout, [0], [ignore])
AT_CHECK(grep otherbranch stdout, [1], [ignore])


AT_CLEANUP
