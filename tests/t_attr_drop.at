AT_SETUP([attr drop])
MONOTONE_SETUP

ADD_FILE(testfile, [foo bar
])
AT_CHECK(MONOTONE attr set testfile test:first_key first_value, [], [ignore], [ignore])
AT_CHECK(MONOTONE attr set testfile test:second_key second_value, [], [ignore], [ignore])
AT_CHECK(MONOTONE attr get testfile, [], [stdout], [ignore])
AT_CHECK(QGREP(test:first_key stdout))
AT_CHECK(QGREP(first_value stdout))
AT_CHECK(QGREP(test:second_key stdout))
AT_CHECK(QGREP(second_value stdout))
AT_CHECK(MONOTONE attr drop testfile test:first_key, [], [stdout], [ignore])
AT_CHECK(MONOTONE attr get testfile, [], [stdout], [ignore])
AT_CHECK(QGREP(test:first_key stdout), [1])
AT_CHECK(QGREP(first_value stdout), [1])
AT_CHECK(QGREP(test:second_key stdout))
AT_CHECK(QGREP(second_value stdout))
AT_CHECK(MONOTONE attr drop testfile, [], [stdout], [ignore])
AT_CHECK(MONOTONE attr get testfile, [], [stdout], [ignore])
AT_CHECK(QGREP(test:first_key stdout), [1])
AT_CHECK(QGREP(first_value stdout), [1])
AT_CHECK(QGREP(test:second_key stdout), [1])
AT_CHECK(QGREP(second_value stdout), [1])

AT_CLEANUP
