#  -*- Autoconf -*-

AT_SETUP([merging an initially forked ancestry])

MONOTONE_SETUP

# this test tries to merge two ancestor-less heads of a branch. ie
#
#  one      two
#   \        /
#     merged
#
# The merge should be conflictless since there are no shared files.

# create the first head
AT_DATA(one, [first file
])
AT_CHECK(MONOTONE add one, [], [ignore], [ignore])
AT_CHECK(MONOTONE --branch=testbranch commit blah-blah, [], [ignore], [ignore])

# create a fork - no common ancestry since they're the first heads.
AT_CHECK(rm -r MT)

AT_DATA(two, [second file
])
AT_CHECK(MONOTONE add two, [], [ignore], [ignore])
AT_CHECK(MONOTONE --branch=testbranch commit blah-blah, [], [ignore], [ignore])

AT_CHECK(MONOTONE --branch=testbranch merge, [], [ignore], [ignore])

AT_CLEANUP
