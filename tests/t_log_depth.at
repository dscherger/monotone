AT_SETUP([only log a few entries instead of the whole log])

# This test checks that 'monotone log' of deleted and renamed files shows
# nothing in a further revision, as they are not applicable any more.

MONOTONE_SETUP

ADD_FILE(foo, [foo
])
AT_CHECK(MONOTONE --branch=testbranch commit --message "Addition of foo.",
         [], [ignore], [ignore])

ADD_FILE(bar, [bar
])
AT_CHECK(MONOTONE --branch=testbranch commit --message "Addition of bar.",
         [], [ignore], [ignore])

ADD_FILE(baz, [baz
])
AT_CHECK(MONOTONE --branch=testbranch commit --message "Addition of baz.",
         [], [ignore], [ignore])

# We know that the lines preceding each log are exactly 65 characters.
# with a newline, the number is 66, hence the test for 66.
AT_CHECK(MONOTONE log --depth=1 | grep '^-------------' | wc -c, 
[], [66
], [ignore])

AT_CLEANUP
