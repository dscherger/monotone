AT_SETUP([use restrictions with --exclude and inodeprints])
MTN_SETUP

AT_CHECK(mkdir foo)
AT_DATA(file1, [x
])
AT_DATA(foo/bar, [y
])

AT_CHECK(MTN add file1, [], [ignore], [ignore])
AT_CHECK(MTN add foo/bar, [], [ignore], [ignore])
AT_CHECK(MTN ci -m 'x', [], [ignore], [ignore])

AT_CHECK(MTN refresh_inodeprints)
AT_CHECK(echo a >>file1)
AT_CHECK(echo b >>foo/bar)
AT_CHECK(MTN ci --exclude foo -m 'x', [], [ignore], [ignore])
AT_CHECK(MTN status --brief | grep "foo/bar", [], [ignore], [ignore])
AT_CHECK(MTN status --brief | grep "file1", [1], [ignore], [ignore])

AT_CLEANUP
