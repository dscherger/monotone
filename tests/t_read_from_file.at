AT_SETUP([mtn read FILE])
MTN_SETUP

AT_CHECK(MTN db init --db foo.db, [], [ignore], [ignore])
AT_CHECK((echo 'foo'; echo 'foo') | MTN --db foo.db genkey foo, [], [ignore], [ignore])

AT_CHECK(MTN --db foo.db pubkey foo >foo.keyfile, [], [ignore], [ignore])
AT_CHECK(MTN read nonexistent, [1], [ignore], [ignore])
AT_CHECK(MTN read foo.keyfile, [], [ignore], [ignore])

AT_CHECK(MTN ls keys, [], [stdout], [ignore])
AT_CHECK(QGREP(foo stdout), [])

AT_CLEANUP