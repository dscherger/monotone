AT_SETUP([checkout fails with multiple heads])

MTN_SETUP

ADD_FILE(testfile, [foo
])
COMMIT(testbranch)
REV1=`BASE_REVISION`

ADD_FILE(file2, [bar
])
COMMIT(testbranch)
REV2=`BASE_REVISION`

AT_CHECK(MTN update -r $REV1, [], [ignore], [ignore])
ADD_FILE(otherfile, [splork
])
COMMIT(testbranch)
REV3=`BASE_REVISION`

AT_CHECK(MTN --branch=testbranch checkout test_dir1,
         [1], [ignore], [stderr])
AT_CHECK(grep $REV2 stderr, [0], [ignore], [ignore])
AT_CHECK(grep $REV3 stderr, [0], [ignore], [ignore])

AT_CLEANUP
